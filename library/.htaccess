RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^.*[^/]$ /$0/ [L,R=301]

RewriteCond index.php -f
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^.*$ index.php?route=$0 [L,QSA]

RewriteCond index.php -f
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^.*[.]php$ index.php?route=$0 [L,QSA]

RewriteCond index.n -f
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^.*$ index.n?route=$0 [L,QSA]

Order Deny,Allow
<FilesMatch "^temp/haquery.log$|^temp/templates/">
    Deny from all
</FilesMatch>
Allow from all
