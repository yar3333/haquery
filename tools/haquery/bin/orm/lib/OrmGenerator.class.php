<?php

class OrmGenerator {
	public function __construct(){}
	static function getClassName($table) {
		$GLOBALS['%s']->push("OrmGenerator::getClassName");
		$製pos = $GLOBALS['%s']->length;
		{
			$裨mp = Lambda::map(_hx_explode("_", strtolower($table)), array(new _hx_lambda(array(&$table), "OrmGenerator_0"), 'execute'))->join("");
			$GLOBALS['%s']->pop();
			return $裨mp;
		}
		$GLOBALS['%s']->pop();
	}
	static function make($basePath) {
		$GLOBALS['%s']->push("OrmGenerator::make");
		$製pos = $GLOBALS['%s']->length;
		$basePath = rtrim(str_replace("\\", "/", $basePath), "/") . "/";
		$modelFolder = $basePath . "models/";
		if(!is_dir($modelFolder)) {
			@mkdir($modelFolder, 493);
		}
		if(!is_dir($modelFolder . "autogenerated")) {
			@mkdir($modelFolder . "autogenerated", 493);
		}
		$tables = haquery_server_db_HaqDb::$connection->getTables();
		{
			$_g = 0;
			while($_g < $tables->length) {
				$table = $tables[$_g];
				++$_g;
				$className = OrmGenerator::getClassName($table);
				OrmModelGenerator::make($table, $basePath, "models." . $className, "models.autogenerated." . $className);
				OrmManagerGenerator::make($table, $basePath, "models." . $className, "models." . $className . "Manager", "models.autogenerated." . $className . "Manager");
				unset($table,$className);
			}
		}
		$GLOBALS['%s']->pop();
	}
	function __toString() { return 'OrmGenerator'; }
}
function OrmGenerator_0(&$table, $w) {
	$製pos = $GLOBALS['%s']->length;
	{
		$GLOBALS['%s']->push("OrmGenerator::getClassName@15");
		$製pos2 = $GLOBALS['%s']->length;
		{
			$裨mp = OrmTools::capitalize($w);
			$GLOBALS['%s']->pop();
			return $裨mp;
		}
		$GLOBALS['%s']->pop();
	}
}
